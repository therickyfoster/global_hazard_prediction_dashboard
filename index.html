<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Natural Hazard Prediction Dashboard</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0a0e27;
            color: #e0e0e0;
            overflow: hidden;
        }

        #container {
            display: grid;
            grid-template-columns: 320px 1fr;
            grid-template-rows: 60px 1fr;
            height: 100vh;
            gap: 0;
        }

        header {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        header h1 {
            font-size: 24px;
            font-weight: 600;
        }

        .status {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #4ade80;
            animation: pulse 2s infinite;
        }

        .status-dot.offline {
            background: #ef4444;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        #sidebar {
            background: #151b32;
            padding: 20px;
            overflow-y: auto;
            border-right: 1px solid #2a3150;
        }

        #map {
            height: 100%;
            width: 100%;
            position: relative;
        }

        .control-panel {
            background: #1e2642;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .control-panel h3 {
            font-size: 14px;
            text-transform: uppercase;
            color: #64748b;
            margin-bottom: 12px;
            letter-spacing: 0.5px;
        }

        .layer-toggle {
            display: flex;
            align-items: center;
            padding: 10px;
            margin-bottom: 8px;
            background: #0f1729;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .layer-toggle:hover {
            background: #1a2038;
            transform: translateX(4px);
        }

        .layer-toggle input {
            margin-right: 10px;
        }

        .layer-toggle label {
            flex: 1;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .layer-icon {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        .earthquake-icon { background: #f59e0b; }
        .fire-icon { background: #ef4444; }
        .flood-icon { background: #3b82f6; }
        .storm-icon { background: #8b5cf6; }
        .volcano-icon { background: #dc2626; }
        .tsunami-icon { background: #06b6d4; }

        #notifications {
            max-height: 300px;
            overflow-y: auto;
        }

        .notification {
            background: #1e2642;
            border-left: 4px solid;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 4px;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .notification.info { border-color: #3b82f6; }
        .notification.warning { border-color: #f59e0b; }
        .notification.critical { border-color: #ef4444; }

        .notification-time {
            font-size: 11px;
            color: #64748b;
            margin-bottom: 4px;
        }

        .notification-text {
            font-size: 13px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }

        .stat-card {
            background: #0f1729;
            padding: 12px;
            border-radius: 6px;
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #60a5fa;
        }

        .stat-label {
            font-size: 11px;
            color: #64748b;
            margin-top: 4px;
        }

        .legend {
            background: #1e2642;
            padding: 10px;
            border-radius: 6px;
            font-size: 12px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 6px;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 3px;
        }

        .prediction-panel {
            background: #0f1729;
            padding: 12px;
            border-radius: 6px;
            margin-top: 10px;
        }

        .prediction-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #2a3150;
        }

        .prediction-item:last-child {
            border-bottom: none;
        }

        .prediction-score {
            font-weight: bold;
        }

        .score-critical { color: #ef4444; }
        .score-high { color: #f59e0b; }
        .score-moderate { color: #eab308; }
        .score-low { color: #22c55e; }

        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #0f1729;
        }

        ::-webkit-scrollbar-thumb {
            background: #2a3150;
            border-radius: 3px;
        }

        .leaflet-popup-content-wrapper {
            background: #1e2642;
            color: #e0e0e0;
        }

        .leaflet-popup-tip {
            background: #1e2642;
        }

        .popup-content h4 {
            margin: 0 0 8px 0;
            color: #60a5fa;
        }

        .popup-content p {
            margin: 4px 0;
            font-size: 13px;
        }

        .refresh-btn {
            background: #2563eb;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            margin-top: 10px;
            width: 100%;
            transition: background 0.2s;
        }

        .refresh-btn:hover {
            background: #1d4ed8;
        }

        .loading {
            display: none;
            color: #60a5fa;
            font-size: 12px;
            text-align: center;
            padding: 10px;
        }

        .loading.active {
            display: block;
        }

        .data-source {
            font-size: 10px;
            color: #64748b;
            margin-top: 5px;
            font-style: italic;
        }

        .language-selector {
            position: relative;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .language-selector select {
            background: rgba(255, 255, 255, 0.1);
            color: #e0e0e0;
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 6px 32px 6px 12px;
            border-radius: 6px;
            font-size: 13px;
            cursor: pointer;
            outline: none;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23e0e0e0' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 8px center;
        }

        .language-selector select:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .language-selector select option {
            background: #1e2642;
            color: #e0e0e0;
        }

        .lang-icon {
            font-size: 18px;
        }

        .translation-loading {
            font-size: 11px;
            color: #94a3b8;
            margin-left: 8px;
        }
    </style>
</head>
<body>
    <div id="container">
        <header>
            <h1 data-i18n="title">üåç Global Hazard Prediction Dashboard</h1>
            <div class="status">
                <div class="language-selector">
                    <span class="lang-icon">üåê</span>
                    <select id="language-select">
                        <option value="en">English</option>
                        <option value="es">Espa√±ol</option>
                        <option value="fr">Fran√ßais</option>
                        <option value="de">Deutsch</option>
                        <option value="zh">‰∏≠Êñá</option>
                        <option value="ja">Êó•Êú¨Ë™û</option>
                        <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
                        <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
                        <option value="pt">Portugu√™s</option>
                        <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                        <option value="it">Italiano</option>
                        <option value="ko">ÌïúÍµ≠Ïñ¥</option>
                    </select>
                    <span class="translation-loading" id="translation-status"></span>
                </div>
                <span class="status-dot" id="status-dot"></span>
                <span id="connection-status" data-i18n="status.connecting">Connecting...</span>
                <span id="last-update" style="font-size: 12px; color: #94a3b8;"></span>
            </div>
        </header>

        <aside id="sidebar">
            <div class="control-panel">
                <h3 data-i18n="layers.title">Active Layers</h3>
                <div class="layer-toggle">
                    <input type="checkbox" id="layer-earthquake" checked>
                    <label for="layer-earthquake">
                        <div class="layer-icon earthquake-icon"></div>
                        <span data-i18n="layers.earthquake">Earthquakes (Live)</span>
                    </label>
                </div>
                <div class="layer-toggle">
                    <input type="checkbox" id="layer-fire" checked>
                    <label for="layer-fire">
                        <div class="layer-icon fire-icon"></div>
                        <span data-i18n="layers.fire">Wildfires</span>
                    </label>
                </div>
                <div class="layer-toggle">
                    <input type="checkbox" id="layer-flood" checked>
                    <label for="layer-flood">
                        <div class="layer-icon flood-icon"></div>
                        <span data-i18n="layers.flood">Floods</span>
                    </label>
                </div>
                <div class="layer-toggle">
                    <input type="checkbox" id="layer-storm" checked>
                    <label for="layer-storm">
                        <div class="layer-icon storm-icon"></div>
                        <span data-i18n="layers.storm">Storms</span>
                    </label>
                </div>
                <div class="layer-toggle">
                    <input type="checkbox" id="layer-volcano" checked>
                    <label for="layer-volcano">
                        <div class="layer-icon volcano-icon"></div>
                        <span data-i18n="layers.volcano">Volcanoes</span>
                    </label>
                </div>
                <div class="layer-toggle">
                    <input type="checkbox" id="layer-tsunami" checked>
                    <label for="layer-tsunami">
                        <div class="layer-icon tsunami-icon"></div>
                        <span data-i18n="layers.tsunami">Tsunamis</span>
                    </label>
                </div>
            </div>

            <div class="control-panel">
                <h3 data-i18n="stats.title">Live Statistics</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="total-events">0</div>
                        <div class="stat-label" data-i18n="stats.total">Total Events (24h)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="critical-events">0</div>
                        <div class="stat-label" data-i18n="stats.critical">Critical Alerts</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="predicted-events">0</div>
                        <div class="stat-label" data-i18n="stats.zones">High Risk Zones</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="affected-regions">0</div>
                        <div class="stat-label" data-i18n="stats.regions">Affected Regions</div>
                    </div>
                </div>
                <button class="refresh-btn" id="refresh-data" data-i18n="buttons.refresh">üîÑ Refresh Data</button>
                <div class="loading" id="loading" data-i18n="status.loading">Fetching live data...</div>
                <div class="data-source" data-i18n="datasource">Data: USGS, GDACS, NASA FIRMS</div>
            </div>

            <div class="control-panel">
                <h3 data-i18n="prediction.title">Prediction Index</h3>
                <div class="prediction-panel" id="predictions">
                    <div class="prediction-item">
                        <span data-i18n="regions.ringoffire">Ring of Fire</span>
                        <span class="prediction-score score-high" data-i18n="severity.high">HIGH</span>
                    </div>
                    <div class="prediction-item">
                        <span data-i18n="regions.caribbean">Caribbean Basin</span>
                        <span class="prediction-score score-moderate" data-i18n="severity.moderate">MODERATE</span>
                    </div>
                    <div class="prediction-item">
                        <span data-i18n="regions.mediterranean">Mediterranean</span>
                        <span class="prediction-score score-moderate" data-i18n="severity.moderate">MODERATE</span>
                    </div>
                </div>
            </div>

            <div class="control-panel">
                <h3 data-i18n="legend.title">Risk Legend</h3>
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #ef4444;"></div>
                        <span data-i18n="legend.critical">Critical (M7.0+)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #f59e0b;"></div>
                        <span data-i18n="legend.high">High (M5.0-6.9)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #eab308;"></div>
                        <span data-i18n="legend.moderate">Moderate (M3.0-4.9)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #22c55e;"></div>
                        <span data-i18n="legend.low">Low (&lt;M3.0)</span>
                    </div>
                </div>
            </div>

            <div class="control-panel">
                <h3 data-i18n="notifications.title">Live Notifications</h3>
                <div id="notifications"></div>
            </div>
        </aside>

        <main id="map"></main>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // ========== TRANSLATION SYSTEM ==========
        const translations = {
            en: {
                title: "üåç Global Hazard Prediction Dashboard",
                "status.connecting": "Connecting...",
                "status.active": "Live Data Active",
                "status.issues": "Connection Issues",
                "status.loading": "Fetching live data...",
                "status.updated": "Updated:",
                "layers.title": "Active Layers",
                "layers.earthquake": "Earthquakes (Live)",
                "layers.fire": "Wildfires",
                "layers.flood": "Floods",
                "layers.storm": "Storms",
                "layers.volcano": "Volcanoes",
                "layers.tsunami": "Tsunamis",
                "stats.title": "Live Statistics",
                "stats.total": "Total Events (24h)",
                "stats.critical": "Critical Alerts",
                "stats.zones": "High Risk Zones",
                "stats.regions": "Affected Regions",
                "buttons.refresh": "üîÑ Refresh Data",
                "datasource": "Data: USGS, GDACS, NASA FIRMS",
                "prediction.title": "Prediction Index",
                "regions.ringoffire": "Ring of Fire",
                "regions.caribbean": "Caribbean Basin",
                "regions.mediterranean": "Mediterranean",
                "severity.high": "HIGH",
                "severity.moderate": "MODERATE",
                "severity.low": "LOW",
                "severity.critical": "CRITICAL",
                "legend.title": "Risk Legend",
                "legend.critical": "Critical (M7.0+)",
                "legend.high": "High (M5.0-6.9)",
                "legend.moderate": "Moderate (M3.0-4.9)",
                "legend.low": "Low (<M3.0)",
                "notifications.title": "Live Notifications",
                "popup.earthquake": "Earthquake",
                "popup.magnitude": "Magnitude:",
                "popup.location": "Location:",
                "popup.depth": "Depth:",
                "popup.time": "Time:",
                "popup.severity": "‰∏•ÈáçÁ®ãÂ∫¶Ôºö",
                "notification.loaded": "‰ªéUSGSÂä†ËΩΩ‰∫Ü{count}Ê¨°Âú∞Èúá",
                "notification.failed": "Âä†ËΩΩÂú∞ÈúáÊï∞ÊçÆÂ§±Ë¥•Ôºö",
                "notification.refreshed": "‰ª™Ë°®ÊùøÊï∞ÊçÆÂ∑≤Âà∑Êñ∞",
                "notification.initializing": "‰ª™Ë°®ÊùøÂàùÂßãÂåñ‰∏≠...",
                "notification.detected": "Âú®{place}ÈôÑËøëÊ£ÄÊµãÂà∞M{mag}Âú∞Èúá"
            },
            ja: {
                title: "üåç „Ç∞„É≠„Éº„Éê„É´ÁÅΩÂÆ≥‰∫àÊ∏¨„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ",
                "status.connecting": "Êé•Á∂ö‰∏≠...",
                "status.active": "„É©„Ç§„Éñ„Éá„Éº„Çø„Ç¢„ÇØ„ÉÜ„Ç£„Éñ",
                "status.issues": "Êé•Á∂ö„ÅÆÂïèÈ°å",
                "status.loading": "„É©„Ç§„Éñ„Éá„Éº„Çø„ÇíÂèñÂæó‰∏≠...",
                "status.updated": "Êõ¥Êñ∞Ôºö",
                "layers.title": "„Ç¢„ÇØ„ÉÜ„Ç£„Éñ„É¨„Ç§„É§„Éº",
                "layers.earthquake": "Âú∞ÈúáÔºà„É©„Ç§„ÉñÔºâ",
                "layers.fire": "Â±±ÁÅ´‰∫ã",
                "layers.flood": "Ê¥™Ê∞¥",
                "layers.storm": "Âµê",
                "layers.volcano": "ÁÅ´Â±±",
                "layers.tsunami": "Ê¥•Ê≥¢",
                "stats.title": "„É©„Ç§„ÉñÁµ±Ë®à",
                "stats.total": "Á∑è„Ç§„Éô„É≥„ÉàÔºà24ÊôÇÈñìÔºâ",
                "stats.critical": "ÈáçÂ§ß„Å™Ë≠¶Âëä",
                "stats.zones": "È´ò„É™„Çπ„ÇØ„Çæ„Éº„É≥",
                "stats.regions": "ÂΩ±Èüø„ÇíÂèó„Åë„ÅüÂú∞Âüü",
                "buttons.refresh": "üîÑ „Éá„Éº„Çø„ÇíÊõ¥Êñ∞",
                "datasource": "„Éá„Éº„ÇøÔºöUSGS„ÄÅGDACS„ÄÅNASA FIRMS",
                "prediction.title": "‰∫àÊ∏¨ÊåáÊï∞",
                "regions.ringoffire": "Áí∞Â§™Âπ≥Ê¥ãÁÅ´Â±±Â∏Ø",
                "regions.caribbean": "„Ç´„É™„ÉñÊµ∑ÁõÜ",
                "regions.mediterranean": "Âú∞‰∏≠Êµ∑",
                "severity.high": "È´ò",
                "severity.moderate": "‰∏≠Á®ãÂ∫¶",
                "severity.low": "‰Ωé",
                "severity.critical": "ÈáçÂ§ß",
                "legend.title": "„É™„Çπ„ÇØÂá°‰æã",
                "legend.critical": "ÈáçÂ§ßÔºàM7.0+Ôºâ",
                "legend.high": "È´òÔºàM5.0-6.9Ôºâ",
                "legend.moderate": "‰∏≠Á®ãÂ∫¶ÔºàM3.0-4.9Ôºâ",
                "legend.low": "‰ΩéÔºà<M3.0Ôºâ",
                "notifications.title": "„É©„Ç§„ÉñÈÄöÁü•",
                "popup.earthquake": "Âú∞Èúá",
                "popup.magnitude": "„Éû„Ç∞„Éã„ÉÅ„É•„Éº„ÉâÔºö",
                "popup.location": "Â†¥ÊâÄÔºö",
                "popup.depth": "Ê∑±„ÅïÔºö",
                "popup.time": "ÊôÇÈñìÔºö",
                "popup.severity": "Ê∑±ÂàªÂ∫¶Ôºö",
                "notification.loaded": "USGS„Åã„Çâ{count}‰ª∂„ÅÆÂú∞Èúá„ÇíË™≠„ÅøËæº„Åø„Åæ„Åó„Åü",
                "notification.failed": "Âú∞Èúá„Éá„Éº„Çø„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±ÊïóÔºö",
                "notification.refreshed": "„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„Éá„Éº„Çø„ÇíÊõ¥Êñ∞„Åó„Åæ„Åó„Åü",
                "notification.initializing": "„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„ÇíÂàùÊúüÂåñ‰∏≠...",
                "notification.detected": "{place}‰ªòËøë„ÅßM{mag}„ÅÆÂú∞Èúá„ÇíÊ§úÂá∫"
            },
            ar: {
                title: "üåç ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ŸÜÿ®ÿ§ ÿ®ÿßŸÑŸÉŸàÿßÿ±ÿ´ ÿßŸÑÿπÿßŸÑŸÖŸäÿ©",
                "status.connecting": "ÿ¨ÿßÿ±Ÿä ÿßŸÑÿßÿ™ÿµÿßŸÑ...",
                "status.active": "ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ≠Ÿäÿ© ŸÜÿ¥ÿ∑ÿ©",
                "status.issues": "ŸÖÿ¥ÿßŸÉŸÑ ŸÅŸä ÿßŸÑÿßÿ™ÿµÿßŸÑ",
                "status.loading": "ÿ¨ŸÑÿ® ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ≠Ÿäÿ©...",
                "status.updated": "ÿ¢ÿÆÿ± ÿ™ÿ≠ÿØŸäÿ´:",
                "layers.title": "ÿßŸÑÿ∑ÿ®ŸÇÿßÿ™ ÿßŸÑŸÜÿ¥ÿ∑ÿ©",
                "layers.earthquake": "ÿßŸÑÿ≤ŸÑÿßÿ≤ŸÑ (ŸÖÿ®ÿßÿ¥ÿ±)",
                "layers.fire": "ÿ≠ÿ±ÿßÿ¶ŸÇ ÿßŸÑÿ∫ÿßÿ®ÿßÿ™",
                "layers.flood": "ÿßŸÑŸÅŸäÿ∂ÿßŸÜÿßÿ™",
                "layers.storm": "ÿßŸÑÿπŸàÿßÿµŸÅ",
                "layers.volcano": "ÿßŸÑÿ®ÿ±ÿßŸÉŸäŸÜ",
                "layers.tsunami": "ÿ™ÿ≥ŸàŸÜÿßŸÖŸä",
                "stats.title": "ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿ≠Ÿäÿ©",
                "stats.total": "ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿ£ÿ≠ÿØÿßÿ´ (24 ÿ≥ÿßÿπÿ©)",
                "stats.critical": "ÿ™ŸÜÿ®ŸäŸáÿßÿ™ ÿ≠ÿ±ÿ¨ÿ©",
                "stats.zones": "ŸÖŸÜÿßÿ∑ŸÇ ÿπÿßŸÑŸäÿ© ÿßŸÑÿÆÿ∑Ÿàÿ±ÿ©",
                "stats.regions": "ÿßŸÑŸÖŸÜÿßÿ∑ŸÇ ÿßŸÑŸÖÿ™ÿ£ÿ´ÿ±ÿ©",
                "buttons.refresh": "üîÑ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™",
                "datasource": "ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™: USGSÿå GDACSÿå NASA FIRMS",
                "prediction.title": "ŸÖÿ§ÿ¥ÿ± ÿßŸÑÿ™ŸÜÿ®ÿ§",
                "regions.ringoffire": "ÿ≠ŸÑŸÇÿ© ÿßŸÑŸÜÿßÿ±",
                "regions.caribbean": "ÿ≠Ÿàÿ∂ ÿßŸÑŸÉÿßÿ±Ÿäÿ®Ÿä",
                "regions.mediterranean": "ÿßŸÑÿ®ÿ≠ÿ± ÿßŸÑŸÖÿ™Ÿàÿ≥ÿ∑",
                "severity.high": "ÿπÿßŸÑŸä",
                "severity.moderate": "ŸÖÿ™Ÿàÿ≥ÿ∑",
                "severity.low": "ŸÖŸÜÿÆŸÅÿ∂",
                "severity.critical": "ÿ≠ÿ±ÿ¨",
                "legend.title": "ŸÖŸÅÿ™ÿßÿ≠ ÿßŸÑŸÖÿÆÿßÿ∑ÿ±",
                "legend.critical": "ÿ≠ÿ±ÿ¨ (M7.0+)",
                "legend.high": "ÿπÿßŸÑŸä (M5.0-6.9)",
                "legend.moderate": "ŸÖÿ™Ÿàÿ≥ÿ∑ (M3.0-4.9)",
                "legend.low": "ŸÖŸÜÿÆŸÅÿ∂ (<M3.0)",
                "notifications.title": "ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿßŸÑÿ≠Ÿäÿ©",
                "popup.earthquake": "ÿ≤ŸÑÿ≤ÿßŸÑ",
                "popup.magnitude": "ÿßŸÑŸÇŸàÿ©:",
                "popup.location": "ÿßŸÑŸÖŸàŸÇÿπ:",
                "popup.depth": "ÿßŸÑÿπŸÖŸÇ:",
                "popup.time": "ÿßŸÑŸàŸÇÿ™:",
                "popup.severity": "ÿßŸÑÿ¥ÿØÿ©:",
                "notification.loaded": "ÿ™ŸÖ ÿ™ÿ≠ŸÖŸäŸÑ {count} ÿ≤ŸÑÿ≤ÿßŸÑ ŸÖŸÜ USGS",
                "notification.failed": "ŸÅÿ¥ŸÑ ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ≤ŸÑÿßÿ≤ŸÑ:",
                "notification.refreshed": "ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÑŸàÿ≠ÿ©",
                "notification.initializing": "ÿ¨ÿßÿ±Ÿä ÿ™ŸáŸäÿ¶ÿ© ÿßŸÑŸÑŸàÿ≠ÿ©...",
                "notification.detected": "ÿ™ŸÖ ÿßŸÉÿ™ÿ¥ÿßŸÅ ÿ≤ŸÑÿ≤ÿßŸÑ M{mag} ÿ®ÿßŸÑŸÇÿ±ÿ® ŸÖŸÜ {place}"
            },
            hi: {
                title: "üåç ‡§µ‡•à‡§∂‡•ç‡§µ‡§ø‡§ï ‡§Ü‡§™‡§¶‡§æ ‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§®‡•Å‡§Æ‡§æ‡§® ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°",
                "status.connecting": "‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...",
                "status.active": "‡§≤‡§æ‡§á‡§µ ‡§°‡•á‡§ü‡§æ ‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø",
                "status.issues": "‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ‡§è‡§Ç",
                "status.loading": "‡§≤‡§æ‡§á‡§µ ‡§°‡•á‡§ü‡§æ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...",
                "status.updated": "‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ:",
                "layers.title": "‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§™‡§∞‡§§‡•á‡§Ç",
                "layers.earthquake": "‡§≠‡•Ç‡§ï‡§Ç‡§™ (‡§≤‡§æ‡§á‡§µ)",
                "layers.fire": "‡§ú‡§Ç‡§ó‡§≤ ‡§ï‡•Ä ‡§Ü‡§ó",
                "layers.flood": "‡§¨‡§æ‡§¢‡§º",
                "layers.storm": "‡§§‡•Ç‡§´‡§æ‡§®",
                "layers.volcano": "‡§ú‡•ç‡§µ‡§æ‡§≤‡§æ‡§Æ‡•Å‡§ñ‡•Ä",
                "layers.tsunami": "‡§∏‡•Å‡§®‡§æ‡§Æ‡•Ä",
                "stats.title": "‡§≤‡§æ‡§á‡§µ ‡§Ü‡§Ç‡§ï‡§°‡§º‡•á",
                "stats.total": "‡§ï‡•Å‡§≤ ‡§ò‡§ü‡§®‡§æ‡§è‡§Ç (24 ‡§ò‡§Ç‡§ü‡•á)",
                "stats.critical": "‡§ó‡§Ç‡§≠‡•Ä‡§∞ ‡§Ö‡§≤‡§∞‡•ç‡§ü",
                "stats.zones": "‡§â‡§ö‡•ç‡§ö ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞",
                "stats.regions": "‡§™‡•ç‡§∞‡§≠‡§æ‡§µ‡§ø‡§§ ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞",
                "buttons.refresh": "üîÑ ‡§°‡•á‡§ü‡§æ ‡§∞‡•Ä‡§´‡•ç‡§∞‡•á‡§∂ ‡§ï‡§∞‡•á‡§Ç",
                "datasource": "‡§°‡•á‡§ü‡§æ: USGS, GDACS, NASA FIRMS",
                "prediction.title": "‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§®‡•Å‡§Æ‡§æ‡§® ‡§∏‡•Ç‡§ö‡§ï‡§æ‡§Ç‡§ï",
                "regions.ringoffire": "‡§∞‡§ø‡§Ç‡§ó ‡§ë‡§´ ‡§´‡§æ‡§Ø‡§∞",
                "regions.caribbean": "‡§ï‡•à‡§∞‡•á‡§¨‡§ø‡§Ø‡§® ‡§¨‡•á‡§∏‡§ø‡§®",
                "regions.mediterranean": "‡§≠‡•Ç‡§Æ‡§ß‡•ç‡§Ø‡§∏‡§æ‡§ó‡§∞‡•Ä‡§Ø",
                "severity.high": "‡§â‡§ö‡•ç‡§ö",
                "severity.moderate": "‡§Æ‡§ß‡•ç‡§Ø‡§Æ",
                "severity.low": "‡§ï‡§Æ",
                "severity.critical": "‡§ó‡§Ç‡§≠‡•Ä‡§∞",
                "legend.title": "‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§ï‡§ø‡§Ç‡§µ‡§¶‡§Ç‡§§‡•Ä",
                "legend.critical": "‡§ó‡§Ç‡§≠‡•Ä‡§∞ (M7.0+)",
                "legend.high": "‡§â‡§ö‡•ç‡§ö (M5.0-6.9)",
                "legend.moderate": "‡§Æ‡§ß‡•ç‡§Ø‡§Æ (M3.0-4.9)",
                "legend.low": "‡§ï‡§Æ (<M3.0)",
                "notifications.title": "‡§≤‡§æ‡§á‡§µ ‡§∏‡•Ç‡§ö‡§®‡§æ‡§è‡§Ç",
                "popup.earthquake": "‡§≠‡•Ç‡§ï‡§Ç‡§™",
                "popup.magnitude": "‡§™‡§∞‡§ø‡§Æ‡§æ‡§£:",
                "popup.location": "‡§∏‡•ç‡§•‡§æ‡§®:",
                "popup.depth": "‡§ó‡§π‡§∞‡§æ‡§à:",
                "popup.time": "‡§∏‡§Æ‡§Ø:",
                "popup.severity": "‡§ó‡§Ç‡§≠‡•Ä‡§∞‡§§‡§æ:",
                "notification.loaded": "USGS ‡§∏‡•á {count} ‡§≠‡•Ç‡§ï‡§Ç‡§™ ‡§≤‡•ã‡§° ‡§ï‡§ø‡§è ‡§ó‡§è",
                "notification.failed": "‡§≠‡•Ç‡§ï‡§Ç‡§™ ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§´‡§≤:",
                "notification.refreshed": "‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° ‡§°‡•á‡§ü‡§æ ‡§∞‡•Ä‡§´‡•ç‡§∞‡•á‡§∂ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ",
                "notification.initializing": "‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° ‡§Ü‡§∞‡§Ç‡§≠ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...",
                "notification.detected": "{place} ‡§ï‡•á ‡§™‡§æ‡§∏ M{mag} ‡§≠‡•Ç‡§ï‡§Ç‡§™ ‡§ï‡§æ ‡§™‡§§‡§æ ‡§ö‡§≤‡§æ"
            },
            pt: {
                title: "üåç Painel de Previs√£o de Desastres Globais",
                "status.connecting": "Conectando...",
                "status.active": "Dados ao Vivo Ativos",
                "status.issues": "Problemas de Conex√£o",
                "status.loading": "Buscando dados ao vivo...",
                "status.updated": "Atualizado:",
                "layers.title": "Camadas Ativas",
                "layers.earthquake": "Terremotos (Ao Vivo)",
                "layers.fire": "Inc√™ndios Florestais",
                "layers.flood": "Inunda√ß√µes",
                "layers.storm": "Tempestades",
                "layers.volcano": "Vulc√µes",
                "layers.tsunami": "Tsunamis",
                "stats.title": "Estat√≠sticas ao Vivo",
                "stats.total": "Eventos Totais (24h)",
                "stats.critical": "Alertas Cr√≠ticos",
                "stats.zones": "Zonas de Alto Risco",
                "stats.regions": "Regi√µes Afetadas",
                "buttons.refresh": "üîÑ Atualizar Dados",
                "datasource": "Dados: USGS, GDACS, NASA FIRMS",
                "prediction.title": "√çndice de Previs√£o",
                "regions.ringoffire": "Anel de Fogo",
                "regions.caribbean": "Bacia do Caribe",
                "regions.mediterranean": "Mediterr√¢neo",
                "severity.high": "ALTO",
                "severity.moderate": "MODERADO",
                "severity.low": "BAIXO",
                "severity.critical": "CR√çTICO",
                "legend.title": "Legenda de Risco",
                "legend.critical": "Cr√≠tico (M7.0+)",
                "legend.high": "Alto (M5.0-6.9)",
                "legend.moderate": "Moderado (M3.0-4.9)",
                "legend.low": "Baixo (<M3.0)",
                "notifications.title": "Notifica√ß√µes ao Vivo",
                "popup.earthquake": "Terremoto",
                "popup.magnitude": "Magnitude:",
                "popup.location": "Localiza√ß√£o:",
                "popup.depth": "Profundidade:",
                "popup.time": "Hora:",
                "popup.severity": "Gravidade:",
                "notification.loaded": "{count} terremotos carregados do USGS",
                "notification.failed": "Falha ao carregar dados de terremotos:",
                "notification.refreshed": "Dados do painel atualizados",
                "notification.initializing": "Inicializando painel...",
                "notification.detected": "Terremoto M{mag} detectado perto de {place}"
            },
            ru: {
                title: "üåç –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ü–∞–Ω–µ–ª—å –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –ö–∞—Ç–∞—Å—Ç—Ä–æ—Ñ",
                "status.connecting": "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...",
                "status.active": "–î–∞–Ω–Ω—ã–µ –≤ –†–µ–∞–ª—å–Ω–æ–º –í—Ä–µ–º–µ–Ω–∏",
                "status.issues": "–ü—Ä–æ–±–ª–µ–º—ã —Å –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º",
                "status.loading": "–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",
                "status.updated": "–û–±–Ω–æ–≤–ª–µ–Ω–æ:",
                "layers.title": "–ê–∫—Ç–∏–≤–Ω—ã–µ –°–ª–æ–∏",
                "layers.earthquake": "–ó–µ–º–ª–µ—Ç—Ä—è—Å–µ–Ω–∏—è (Live)",
                "layers.fire": "–õ–µ—Å–Ω—ã–µ –ü–æ–∂–∞—Ä—ã",
                "layers.flood": "–ù–∞–≤–æ–¥–Ω–µ–Ω–∏—è",
                "layers.storm": "–®—Ç–æ—Ä–º—ã",
                "layers.volcano": "–í—É–ª–∫–∞–Ω—ã",
                "layers.tsunami": "–¶—É–Ω–∞–º–∏",
                "stats.title": "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ –†–µ–∞–ª—å–Ω–æ–º –í—Ä–µ–º–µ–Ω–∏",
                "stats.total": "–í—Å–µ–≥–æ –°–æ–±—ã—Ç–∏–π (24—á)",
                "stats.critical": "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –û–ø–æ–≤–µ—â–µ–Ω–∏—è",
                "stats.zones": "–ó–æ–Ω—ã –í—ã—Å–æ–∫–æ–≥–æ –†–∏—Å–∫–∞",
                "stats.regions": "–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –†–µ–≥–∏–æ–Ω—ã",
                "buttons.refresh": "üîÑ –û–±–Ω–æ–≤–∏—Ç—å –î–∞–Ω–Ω—ã–µ",
                "datasource": "–î–∞–Ω–Ω—ã–µ: USGS, GDACS, NASA FIRMS",
                "prediction.title": "–ò–Ω–¥–µ–∫—Å –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è",
                "regions.ringoffire": "–¢–∏—Ö–æ–æ–∫–µ–∞–Ω—Å–∫–æ–µ –û–≥–Ω–µ–Ω–Ω–æ–µ –ö–æ–ª—å—Ü–æ",
                "regions.caribbean": "–ö–∞—Ä–∏–±—Å–∫–∏–π –ë–∞—Å—Å–µ–π–Ω",
                "regions.mediterranean": "–°—Ä–µ–¥–∏–∑–µ–º–Ω–æ–º–æ—Ä—å–µ",
                "severity.high": "–í–´–°–û–ö–ò–ô",
                "severity.moderate": "–£–ú–ï–†–ï–ù–ù–´–ô",
                "severity.low": "–ù–ò–ó–ö–ò–ô",
                "severity.critical": "–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô",
                "legend.title": "–õ–µ–≥–µ–Ω–¥–∞ –†–∏—Å–∫–æ–≤",
                "legend.critical": "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π (M7.0+)",
                "legend.high": "–í—ã—Å–æ–∫–∏–π (M5.0-6.9)",
                "legend.moderate": "–£–º–µ—Ä–µ–Ω–Ω—ã–π (M3.0-4.9)",
                "legend.low": "–ù–∏–∑–∫–∏–π (<M3.0)",
                "notifications.title": "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è",
                "popup.earthquake": "–ó–µ–º–ª–µ—Ç—Ä—è—Å–µ–Ω–∏–µ",
                "popup.magnitude": "–ú–∞–≥–Ω–∏—Ç—É–¥–∞:",
                "popup.location": "–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:",
                "popup.depth": "–ì–ª—É–±–∏–Ω–∞:",
                "popup.time": "–í—Ä–µ–º—è:",
                "popup.severity": "–°—Ç–µ–ø–µ–Ω—å:",
                "notification.loaded": "–ó–∞–≥—Ä—É–∂–µ–Ω–æ {count} –∑–µ–º–ª–µ—Ç—Ä—è—Å–µ–Ω–∏–π –∏–∑ USGS",
                "notification.failed": "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:",
                "notification.refreshed": "–î–∞–Ω–Ω—ã–µ –ø–∞–Ω–µ–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã",
                "notification.initializing": "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–Ω–µ–ª–∏...",
                "notification.detected": "–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –∑–µ–º–ª–µ—Ç—Ä—è—Å–µ–Ω–∏–µ M{mag} –æ–∫–æ–ª–æ {place}"
            },
            it: {
                title: "üåç Dashboard Globale di Previsione Disastri",
                "status.connecting": "Connessione...",
                "status.active": "Dati in Tempo Reale Attivi",
                "status.issues": "Problemi di Connessione",
                "status.loading": "Recupero dati in tempo reale...",
                "status.updated": "Aggiornato:",
                "layers.title": "Livelli Attivi",
                "layers.earthquake": "Terremoti (Live)",
                "layers.fire": "Incendi Boschivi",
                "layers.flood": "Alluvioni",
                "layers.storm": "Tempeste",
                "layers.volcano": "Vulcani",
                "layers.tsunami": "Tsunami",
                "stats.title": "Statistiche in Tempo Reale",
                "stats.total": "Eventi Totali (24h)",
                "stats.critical": "Avvisi Critici",
                "stats.zones": "Zone ad Alto Rischio",
                "stats.regions": "Regioni Colpite",
                "buttons.refresh": "üîÑ Aggiorna Dati",
                "datasource": "Dati: USGS, GDACS, NASA FIRMS",
                "prediction.title": "Indice di Previsione",
                "regions.ringoffire": "Anello di Fuoco",
                "regions.caribbean": "Bacino Caraibico",
                "regions.mediterranean": "Mediterraneo",
                "severity.high": "ALTO",
                "severity.moderate": "MODERATO",
                "severity.low": "BASSO",
                "severity.critical": "CRITICO",
                "legend.title": "Legenda Rischi",
                "legend.critical": "Critico (M7.0+)",
                "legend.high": "Alto (M5.0-6.9)",
                "legend.moderate": "Moderato (M3.0-4.9)",
                "legend.low": "Basso (<M3.0)",
                "notifications.title": "Notifiche in Tempo Reale",
                "popup.earthquake": "Terremoto",
                "popup.magnitude": "Magnitudo:",
                "popup.location": "Posizione:",
                "popup.depth": "Profondit√†:",
                "popup.time": "Ora:",
                "popup.severity": "Gravit√†:",
                "notification.loaded": "{count} terremoti caricati da USGS",
                "notification.failed": "Impossibile caricare i dati dei terremoti:",
                "notification.refreshed": "Dati dashboard aggiornati",
                "notification.initializing": "Inizializzazione dashboard...",
                "notification.detected": "Terremoto M{mag} rilevato vicino a {place}"
            },
            ko: {
                title: "üåç Í∏ÄÎ°úÎ≤å Ïû¨ÎÇú ÏòàÏ∏° ÎåÄÏãúÎ≥¥Îìú",
                "status.connecting": "Ïó∞Í≤∞ Ï§ë...",
                "status.active": "Ïã§ÏãúÍ∞Ñ Îç∞Ïù¥ÌÑ∞ ÌôúÏÑ±",
                "status.issues": "Ïó∞Í≤∞ Î¨∏Ï†ú",
                "status.loading": "Ïã§ÏãúÍ∞Ñ Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Îäî Ï§ë...",
                "status.updated": "ÏóÖÎç∞Ïù¥Ìä∏:",
                "layers.title": "ÌôúÏÑ± Î†àÏù¥Ïñ¥",
                "layers.earthquake": "ÏßÄÏßÑ (Ïã§ÏãúÍ∞Ñ)",
                "layers.fire": "ÏÇ∞Î∂à",
                "layers.flood": "ÌôçÏàò",
                "layers.storm": "Ìè≠Ìíç",
                "layers.volcano": "ÌôîÏÇ∞",
                "layers.tsunami": "Ïì∞ÎÇòÎØ∏",
                "stats.title": "Ïã§ÏãúÍ∞Ñ ÌÜµÍ≥Ñ",
                "stats.total": "Ï¥ù Ïù¥Î≤§Ìä∏ (24ÏãúÍ∞Ñ)",
                "stats.critical": "Ïã¨Í∞ÅÌïú Í≤ΩÎ≥¥",
                "stats.zones": "Í≥†ÏúÑÌóò Íµ¨Ïó≠",
                "stats.regions": "ÏòÅÌñ•Î∞õÏùÄ ÏßÄÏó≠",
                "buttons.refresh": "üîÑ Îç∞Ïù¥ÌÑ∞ ÏÉàÎ°úÍ≥†Ïπ®",
                "datasource": "Îç∞Ïù¥ÌÑ∞: USGS, GDACS, NASA FIRMS",
                "prediction.title": "ÏòàÏ∏° ÏßÄÏàò",
                "regions.ringoffire": "ÌôòÌÉúÌèâÏñë Ï°∞ÏÇ∞ÎåÄ",
                "regions.caribbean": "Ïπ¥Î¶¨Î∏åÌï¥ Î∂ÑÏßÄ",
                "regions.mediterranean": "ÏßÄÏ§ëÌï¥",
                "severity.high": "ÎÜíÏùå",
                "severity.moderate": "Î≥¥ÌÜµ",
                "severity.low": "ÎÇÆÏùå",
                "severity.critical": "Ïã¨Í∞Å",
                "legend.title": "ÏúÑÌóò Î≤îÎ°Ä",
                "legend.critical": "Ïã¨Í∞Å (M7.0+)",
                "legend.high": "ÎÜíÏùå (M5.0-6.9)",
                "legend.moderate": "Î≥¥ÌÜµ (M3.0-4.9)",
                "legend.low": "ÎÇÆÏùå (<M3.0)",
                "notifications.title": "Ïã§ÏãúÍ∞Ñ ÏïåÎ¶º",
                "popup.earthquake": "ÏßÄÏßÑ",
                "popup.magnitude": "Í∑úÎ™®:",
                "popup.location": "ÏúÑÏπò:",
                "popup.depth": "ÍπäÏù¥:",
                "popup.time": "ÏãúÍ∞Ñ:",
                "popup.severity": "Ïã¨Í∞ÅÎèÑ:",
                "notification.loaded": "USGSÏóêÏÑú {count}Í∞ú ÏßÄÏßÑ Î°úÎìúÎê®",
                "notification.failed": "ÏßÄÏßÑ Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®:",
                "notification.refreshed": "ÎåÄÏãúÎ≥¥Îìú Îç∞Ïù¥ÌÑ∞ ÏÉàÎ°úÍ≥†Ïπ®Îê®",
                "notification.initializing": "ÎåÄÏãúÎ≥¥Îìú Ï¥àÍ∏∞Ìôî Ï§ë...",
                "notification.detected": "{place} Í∑ºÏ≤òÏóêÏÑú M{mag} ÏßÄÏßÑ Í∞êÏßÄÎê®"
            }
        };

        let currentLang = 'en';

        // Translation function
        function t(key, params = {}) {
            const lang = translations[currentLang] || translations.en;
            let text = lang[key] || translations.en[key] || key;
            
            // Replace parameters like {count}, {mag}, {place}
            Object.keys(params).forEach(param => {
                text = text.replace(`{${param}}`, params[param]);
            });
            
            return text;
        }

        // Apply translations to all elements with data-i18n attribute
        function applyTranslations() {
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                el.textContent = t(key);
            });
            
            // Update document direction for RTL languages
            if (currentLang === 'ar') {
                document.body.style.direction = 'rtl';
            } else {
                document.body.style.direction = 'ltr';
            }
            
            document.getElementById('translation-status').textContent = '';
        }

        // Language selector event
        document.getElementById('language-select').addEventListener('change', (e) => {
            currentLang = e.target.value;
            document.getElementById('translation-status').textContent = '‚è≥';
            
            // Store preference
            try {
                localStorage.setItem('hazard-dashboard-lang', currentLang);
            } catch(e) {}
            
            applyTranslations();
            
            // Re-fetch data to update popups with new language
            if (typeof fetchEarthquakeData === 'function') {
                fetchEarthquakeData();
            }
        });

        // Detect browser language on load
        function detectLanguage() {
            const browserLang = navigator.language.split('-')[0];
            return translations[browserLang] ? browserLang : 'en';
        }

        // ========== CORS PROXY CONFIGURATION ==========
        const CORS_PROXIES = [
            'https://api.allorigins.win/raw?url=',
            'https://corsproxy.io/?',
            'https://api.codetabs.com/v1/proxy?quest='
        ];

        async function fetchWithProxy(url) {
            for (let i = 0; i < CORS_PROXIES.length; i++) {
                try {
                    const proxy = CORS_PROXIES[i];
                    const proxiedUrl = proxy + encodeURIComponent(url);
                    const response = await fetch(proxiedUrl);
                    if (!response.ok) throw new Error(`HTTP ${response.status}`);
                    return await response.json();
                } catch (error) {
                    if (i === CORS_PROXIES.length - 1) throw error;
                }
            }
        }

        // ========== MAP INITIALIZATION ==========
        const map = L.map('map').setView([20, 0], 2);

        L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
            attribution: '¬©OpenStreetMap, ¬©CartoDB',
            subdomains: 'abcd',
            maxZoom: 19
        }).addTo(map);

        const layers = {
            earthquake: L.layerGroup().addTo(map),
            fire: L.layerGroup().addTo(map),
            flood: L.layerGroup().addTo(map),
            storm: L.layerGroup().addTo(map),
            volcano: L.layerGroup().addTo(map),
            tsunami: L.layerGroup().addTo(map)
        };

        // ========== GLOBAL STATE ==========
        let totalEvents = 0;
        let criticalEvents = 0;
        let affectedRegions = new Set();

        // ========== LIVE DATA FETCHING ==========
        async function fetchEarthquakeData() {
            try {
                showLoading(true);
                const data = await fetchWithProxy('https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_day.geojson');
                
                layers.earthquake.clearLayers();
                let earthquakeCount = 0;
                totalEvents = 0;
                criticalEvents = 0;
                affectedRegions.clear();
                
                data.features.forEach(feature => {
                    const props = feature.properties;
                    const coords = feature.geometry.coordinates;
                    const mag = props.mag || 0;
                    const place = props.place || 'Unknown';
                    
                    let color, severity;
                    if (mag >= 7.0) {
                        color = '#ef4444'; severity = 'critical'; criticalEvents++;
                    } else if (mag >= 5.0) {
                        color = '#f59e0b'; severity = 'high';
                    } else if (mag >= 3.0) {
                        color = '#eab308'; severity = 'moderate';
                    } else {
                        color = '#22c55e'; severity = 'low';
                    }
                    
                    const marker = L.circleMarker([coords[1], coords[0]], {
                        radius: Math.max(4, mag * 2),
                        fillColor: color,
                        color: '#fff',
                        weight: 1,
                        opacity: 0.8,
                        fillOpacity: 0.6
                    }).addTo(layers.earthquake);
                    
                    marker.bindPopup(`
                        <div class="popup-content">
                            <h4>üåã ${t('popup.earthquake')}</h4>
                            <p><strong>${t('popup.magnitude')}</strong> ${mag.toFixed(1)}</p>
                            <p><strong>${t('popup.location')}</strong> ${place}</p>
                            <p><strong>${t('popup.depth')}</strong> ${coords[2].toFixed(1)} km</p>
                            <p><strong>${t('popup.time')}</strong> ${new Date(props.time).toLocaleString()}</p>
                            <p><strong>${t('popup.severity')}</strong> ${t('severity.' + severity).toUpperCase()}</p>
                        </div>
                    `);
                    
                    totalEvents++;
                    earthquakeCount++;
                    affectedRegions.add(place.split(',').pop().trim());
                    
                    if (mag >= 5.0) {
                        addNotification(t('notification.detected', { mag: mag.toFixed(1), place }), severity);
                    }
                });
                
                addNotification(t('notification.loaded', { count: earthquakeCount }), 'info');
                updateConnectionStatus(true);
                updateStats();
                showLoading(false);
                
            } catch (error) {
                console.error('Error:', error);
                addNotification(t('notification.failed') + ' ' + error.message, 'warning');
                updateConnectionStatus(false);
                showLoading(false);
            }
        }

        // ========== UTILITY FUNCTIONS ==========
        function addNotification(text, type = 'info') {
            const notificationEl = document.createElement('div');
            notificationEl.className = `notification ${type}`;
            notificationEl.innerHTML = `
                <div class="notification-time">${new Date().toLocaleTimeString()}</div>
                <div class="notification-text">${text}</div>
            `;
            
            const container = document.getElementById('notifications');
            container.insertBefore(notificationEl, container.firstChild);
            while (container.children.length > 10) {
                container.removeChild(container.lastChild);
            }
        }

        function updateStats() {
            document.getElementById('total-events').textContent = totalEvents;
            document.getElementById('critical-events').textContent = criticalEvents;
            document.getElementById('predicted-events').textContent = '28';
            document.getElementById('affected-regions').textContent = affectedRegions.size;
        }

        function updateConnectionStatus(isConnected) {
            const statusEl = document.getElementById('connection-status');
            const dotEl = document.getElementById('status-dot');
            const updateEl = document.getElementById('last-update');
            
            if (isConnected) {
                statusEl.textContent = t('status.active');
                dotEl.classList.remove('offline');
                updateEl.textContent = t('status.updated') + ' ' + new Date().toLocaleTimeString();
            } else {
                statusEl.textContent = t('status.issues');
                dotEl.classList.add('offline');
            }
        }

        function showLoading(show) {
            const loadingEl = document.getElementById('loading');
            loadingEl.classList.toggle('active', show);
        }

        // ========== LAYER TOGGLES ==========
        document.querySelectorAll('.layer-toggle input').forEach(checkbox => {
            checkbox.addEventListener('change', (e) => {
                const layerName = e.target.id.replace('layer-', '');
                if (e.target.checked) {
                    map.addLayer(layers[layerName]);
                } else {
                    map.removeLayer(layers[layerName]);
                }
            });
        });

        // ========== REFRESH BUTTON ==========
        document.getElementById('refresh-data').addEventListener('click', async () => {
            await fetchEarthquakeData();
            addNotification(t('notification.refreshed'), 'info');
        });

        // ========== INITIALIZATION ==========
        async function initialize() {
            // Set initial language
            currentLang = detectLanguage();
            document.getElementById('language-select').value = currentLang;
            applyTranslations();
            
            addNotification(t('notification.initializing'), 'info');
            await fetchEarthquakeData();
            
            // Auto-refresh every 5 minutes
            setInterval(fetchEarthquakeData, 300000);
        }

        initialize();": "Severity:",
                "notification.loaded": "Loaded {count} earthquakes from USGS",
                "notification.failed": "Failed to load live earthquake data:",
                "notification.refreshed": "Dashboard data refreshed",
                "notification.initializing": "Dashboard initializing...",
                "notification.detected": "M{mag} earthquake detected near {place}"
            },
            es: {
                title: "üåç Panel de Predicci√≥n de Desastres Naturales",
                "status.connecting": "Conectando...",
                "status.active": "Datos en Vivo Activos",
                "status.issues": "Problemas de Conexi√≥n",
                "status.loading": "Obteniendo datos en vivo...",
                "status.updated": "Actualizado:",
                "layers.title": "Capas Activas",
                "layers.earthquake": "Terremotos (En Vivo)",
                "layers.fire": "Incendios Forestales",
                "layers.flood": "Inundaciones",
                "layers.storm": "Tormentas",
                "layers.volcano": "Volcanes",
                "layers.tsunami": "Tsunamis",
                "stats.title": "Estad√≠sticas en Vivo",
                "stats.total": "Eventos Totales (24h)",
                "stats.critical": "Alertas Cr√≠ticas",
                "stats.zones": "Zonas de Alto Riesgo",
                "stats.regions": "Regiones Afectadas",
                "buttons.refresh": "üîÑ Actualizar Datos",
                "datasource": "Datos: USGS, GDACS, NASA FIRMS",
                "prediction.title": "√çndice de Predicci√≥n",
                "regions.ringoffire": "Anillo de Fuego",
                "regions.caribbean": "Cuenca del Caribe",
                "regions.mediterranean": "Mediterr√°neo",
                "severity.high": "ALTO",
                "severity.moderate": "MODERADO",
                "severity.low": "BAJO",
                "severity.critical": "CR√çTICO",
                "legend.title": "Leyenda de Riesgo",
                "legend.critical": "Cr√≠tico (M7.0+)",
                "legend.high": "Alto (M5.0-6.9)",
                "legend.moderate": "Moderado (M3.0-4.9)",
                "legend.low": "Bajo (<M3.0)",
                "notifications.title": "Notificaciones en Vivo",
                "popup.earthquake": "Terremoto",
                "popup.magnitude": "Magnitud:",
                "popup.location": "Ubicaci√≥n:",
                "popup.depth": "Profundidad:",
                "popup.time": "Hora:",
                "popup.severity": "Gravedad:",
                "notification.loaded": "{count} terremotos cargados de USGS",
                "notification.failed": "Error al cargar datos de terremotos:",
                "notification.refreshed": "Datos del panel actualizados",
                "notification.initializing": "Inicializando panel...",
                "notification.detected": "Terremoto M{mag} detectado cerca de {place}"
            },
            fr: {
                title: "üåç Tableau de Bord de Pr√©diction des Catastrophes",
                "status.connecting": "Connexion...",
                "status.active": "Donn√©es en Direct Actives",
                "status.issues": "Probl√®mes de Connexion",
                "status.loading": "R√©cup√©ration des donn√©es en direct...",
                "status.updated": "Mis √† jour:",
                "layers.title": "Couches Actives",
                "layers.earthquake": "Tremblements de Terre (Direct)",
                "layers.fire": "Feux de For√™t",
                "layers.flood": "Inondations",
                "layers.storm": "Temp√™tes",
                "layers.volcano": "Volcans",
                "layers.tsunami": "Tsunamis",
                "stats.title": "Statistiques en Direct",
                "stats.total": "√âv√©nements Totaux (24h)",
                "stats.critical": "Alertes Critiques",
                "stats.zones": "Zones √† Haut Risque",
                "stats.regions": "R√©gions Affect√©es",
                "buttons.refresh": "üîÑ Actualiser les Donn√©es",
                "datasource": "Donn√©es: USGS, GDACS, NASA FIRMS",
                "prediction.title": "Indice de Pr√©diction",
                "regions.ringoffire": "Ceinture de Feu",
                "regions.caribbean": "Bassin Cara√Øbe",
                "regions.mediterranean": "M√©diterran√©e",
                "severity.high": "√âLEV√â",
                "severity.moderate": "MOD√âR√â",
                "severity.low": "FAIBLE",
                "severity.critical": "CRITIQUE",
                "legend.title": "L√©gende des Risques",
                "legend.critical": "Critique (M7.0+)",
                "legend.high": "√âlev√© (M5.0-6.9)",
                "legend.moderate": "Mod√©r√© (M3.0-4.9)",
                "legend.low": "Faible (<M3.0)",
                "notifications.title": "Notifications en Direct",
                "popup.earthquake": "Tremblement de Terre",
                "popup.magnitude": "Magnitude:",
                "popup.location": "Emplacement:",
                "popup.depth": "Profondeur:",
                "popup.time": "Heure:",
                "popup.severity": "Gravit√©:",
                "notification.loaded": "{count} tremblements de terre charg√©s depuis USGS",
                "notification.failed": "√âchec du chargement des donn√©es sismiques:",
                "notification.refreshed": "Donn√©es du tableau de bord actualis√©es",
                "notification.initializing": "Initialisation du tableau de bord...",
                "notification.detected": "S√©isme M{mag} d√©tect√© pr√®s de {place}"
            },
            de: {
                title: "üåç Globales Katastrophen-Vorhersage-Dashboard",
                "status.connecting": "Verbinden...",
                "status.active": "Live-Daten Aktiv",
                "status.issues": "Verbindungsprobleme",
                "status.loading": "Live-Daten abrufen...",
                "status.updated": "Aktualisiert:",
                "layers.title": "Aktive Ebenen",
                "layers.earthquake": "Erdbeben (Live)",
                "layers.fire": "Waldbr√§nde",
                "layers.flood": "√úberschwemmungen",
                "layers.storm": "St√ºrme",
                "layers.volcano": "Vulkane",
                "layers.tsunami": "Tsunamis",
                "stats.title": "Live-Statistiken",
                "stats.total": "Gesamtereignisse (24h)",
                "stats.critical": "Kritische Warnungen",
                "stats.zones": "Hochrisikozonen",
                "stats.regions": "Betroffene Regionen",
                "buttons.refresh": "üîÑ Daten Aktualisieren",
                "datasource": "Daten: USGS, GDACS, NASA FIRMS",
                "prediction.title": "Vorhersageindex",
                "regions.ringoffire": "Pazifischer Feuerring",
                "regions.caribbean": "Karibisches Becken",
                "regions.mediterranean": "Mittelmeer",
                "severity.high": "HOCH",
                "severity.moderate": "MITTEL",
                "severity.low": "NIEDRIG",
                "severity.critical": "KRITISCH",
                "legend.title": "Risikolegende",
                "legend.critical": "Kritisch (M7.0+)",
                "legend.high": "Hoch (M5.0-6.9)",
                "legend.moderate": "Mittel (M3.0-4.9)",
                "legend.low": "Niedrig (<M3.0)",
                "notifications.title": "Live-Benachrichtigungen",
                "popup.earthquake": "Erdbeben",
                "popup.magnitude": "Magnitude:",
                "popup.location": "Ort:",
                "popup.depth": "Tiefe:",
                "popup.time": "Zeit:",
                "popup.severity": "Schweregrad:",
                "notification.loaded": "{count} Erdbeben von USGS geladen",
                "notification.failed": "Fehler beim Laden der Erdbebendaten:",
                "notification.refreshed": "Dashboard-Daten aktualisiert",
                "notification.initializing": "Dashboard wird initialisiert...",
                "notification.detected": "M{mag} Erdbeben in der N√§he von {place} erkannt"
            },
            zh: {
                title: "üåç ÂÖ®ÁêÉÁÅæÂÆ≥È¢ÑÊµã‰ª™Ë°®Êùø",
                "status.connecting": "ËøûÊé•‰∏≠...",
                "status.active": "ÂÆûÊó∂Êï∞ÊçÆÂ∑≤ÊøÄÊ¥ª",
                "status.issues": "ËøûÊé•ÈóÆÈ¢ò",
                "status.loading": "Ëé∑ÂèñÂÆûÊó∂Êï∞ÊçÆ...",
                "status.updated": "Êõ¥Êñ∞Êó∂Èó¥Ôºö",
                "layers.title": "Ê¥ªÂä®ÂõæÂ±Ç",
                "layers.earthquake": "Âú∞ÈúáÔºàÂÆûÊó∂Ôºâ",
                "layers.fire": "Ê£ÆÊûóÁÅ´ÁÅæ",
                "layers.flood": "Ê¥™Ê∞¥",
                "layers.storm": "È£éÊö¥",
                "layers.volcano": "ÁÅ´Â±±",
                "layers.tsunami": "Êµ∑Âï∏",
                "stats.title": "ÂÆûÊó∂ÁªüËÆ°",
                "stats.total": "ÊÄª‰∫ã‰ª∂Êï∞Ôºà24Â∞èÊó∂Ôºâ",
                "stats.critical": "‰∏•ÈáçË≠¶Êä•",
                "stats.zones": "È´òÈ£éÈô©Âå∫",
                "stats.regions": "ÂèóÂΩ±ÂìçÂú∞Âå∫",
                "buttons.refresh": "üîÑ Âà∑Êñ∞Êï∞ÊçÆ",
                "datasource": "Êï∞ÊçÆÊù•Ê∫êÔºöUSGS„ÄÅGDACS„ÄÅNASA FIRMS",
                "prediction.title": "È¢ÑÊµãÊåáÊï∞",
                "regions.ringoffire": "ÁéØÂ§™Âπ≥Ê¥ãÁÅ´Â±±Â∏¶",
                "regions.caribbean": "Âä†ÂãíÊØîÊµ∑ÁõÜÂú∞",
                "regions.mediterranean": "Âú∞‰∏≠Êµ∑",
                "severity.high": "È´ò",
                "severity.moderate": "‰∏≠Á≠â",
                "severity.low": "‰Ωé",
                "severity.critical": "‰∏•Èáç",
                "legend.title": "È£éÈô©Âõæ‰æã",
                "legend.critical": "‰∏•ÈáçÔºàM7.0+Ôºâ",
                "legend.high": "È´òÔºàM5.0-6.9Ôºâ",
                "legend.moderate": "‰∏≠Á≠âÔºàM3.0-4.9Ôºâ",
                "legend.low": "‰ΩéÔºà<M3.0Ôºâ",
                "notifications.title": "ÂÆûÊó∂ÈÄöÁü•",
                "popup.earthquake": "Âú∞Èúá",
                "popup.magnitude": "ÈúáÁ∫ßÔºö",
                "popup.location": "‰ΩçÁΩÆÔºö",
                "popup.depth": "Ê∑±Â∫¶Ôºö",
                "popup.time": "Êó∂Èó¥Ôºö",
                "popup.severity": "?: ",
